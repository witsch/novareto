<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="plone">
  <head>
    <metal:block metal:fill-slot="head_slot">
      <script>

      </script>
    </metal:block>
  </head>
  <body>
    <metal:main fill-slot="main" >
      <h1 class="documentFirstHeading">Calendar View</h1>
      <div tal:condition="not: view/overflow">
	<h2>Rendering events for <span tal:content="view/current_year" /></h2>
	<p>
	  <a href=""
	     tal:condition="view/previous_year"
	     tal:attributes="href string:${context/absolute_url}/?year=${view/previous_year}">&larr; previous</a>
	  <tal:sep condition="python: view.next_year and view.previous_year">
	    &bull;
	  </tal:sep>
	  <a href=""
	     tal:condition="view/next_year"
	     tal:attributes="href string:${context/absolute_url}/?year=${view/next_year}">next &rarr;</a>
	</p>

	<tal:events tal:repeat="month python:sorted(view.events.keys())"
		    tal:define="toLocalizedTime nocall: context/@@plone/toLocalizedTime;">

	  <h3>Month: <span tal:content="month" /></h3>

	  <metal:block tal:repeat="event python:view.events[month]">

	  <div class="newsItem"
	       metal:define-macro="listitem"
	       tal:define="result python:event[1];
			   status python:event[0];
			   resultObject result/getObject;
			   creator result/Creator;
			   resulturl resultObject/absolute_url;">
                <h2>
                    <a href="/view"
                       tal:attributes="href resulturl"
                       tal:content="result/pretty_title_or_id">
                        Event headline
                    </a>
                </h2>
                <div class="newsContent">
                    <p tal:content="result/Description">
                        Description
                    </p>
                    <ul class="newsAbout">
                        <li tal:define="subject resultObject/Subject"
                            tal:condition="subject">
			  <span tal:replace="python:modules['string'].join(subject, ' ')">Conference</span>
                        </li>
			<li tal:content="status" />
                        <li>
			  <span tal:replace="python:toLocalizedTime(resultObject.start(), long_format=1)">Start Date Time</span>
			  <span i18n:translate="event_and">to</span>
			  <span tal:replace="python:toLocalizedTime(resultObject.end(), long_format=1)">End Date Time</span>.
                        </li>
                    </ul>
		    
                    <ul class="newsFooter">
		      <li>
			<a href="/view" tal:attributes="href resulturl" i18n:translate="read_more">
			  <span class="hiddenStructure"><span tal:replace="result/pretty_title_or_id" /> - </span>
			  <span i18n:translate="read_more">Read More&hellip;</span>
			</a>
		      </li>

                    </ul>
                </div>
            </div>
        </metal:block>
	</tal:events>

      </div>
      <div tal:condition="view/overflow">
	You're too far in the future or in the past.
	Please use the provided links to access the events.
	<a href="" tal:attributes="href string:${context/absolute_url}"
	   >Return to the index</a>.
      </div>
    </metal:main>
  </body>
</html>
